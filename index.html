<!DOCTYPE html>
<html lang="ru"> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-key="gameTitle">Игра "Жизнь"</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1><span data-lang-key="gameTitle">Игра "Жизнь"</span></h1>

    <canvas id="gameCanvas"></canvas>

    <div class="language-switcher">
        <label for="languageSelect">Язык:</label>
        <select id="languageSelect">
            <option value="ru">Русский</option>
            <option value="en">English</option>
        </select>
    </div>


    <div class="controls">
        <button id="startButton" data-lang-key="startButton">Старт</button>
        <button id="pauseButton" data-lang-key="pauseButton">Пауза</button>
        <button id="randomButton" data-lang-key="randomButton">Случайно</button>
        <button id="clearButton" data-lang-key="clearButton">Очистить</button>
        <button id="settingsButton" data-lang-key="settingsButton">Настройки (Размер, Правила, Сохранить)</button>
    </div>

    <div class="settings-container">
        <label for="speedInput" data-lang-key="speedLabel">Скорость (поколений/сек):</label>
        <input type="number" id="speedInput" min="1" value="10" style="width: 60px;">
        <input type="range" id="speedSlider" min="1" max="20" value="10">
    </div>

    <div class="info">
        <span data-lang-key="generationLabel">Поколение</span>: <span id="generationCount">0</span> | <span data-lang-key="liveCellsLabel">Живых клеток</span>: <span id="liveCellCount">0</span>
    </div>

    <p data-lang-key="manualDrawHint">Нажмите на клетки на поле, чтобы установить или убрать их вручную (работает в режиме паузы). Зажмите и ведите мышь для рисования.</p>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" data-modal="settingsModal">&times;</span>
            <h2 data-lang-key="settingsModalTitle">Настройки</h2>

            <div class="setting-section">
                <h3 data-lang-key="displaySettingsTitle">Отображение</h3>
                <div>
                    <label for="liveColorPicker" data-lang-key="liveColorLabel">Цвет живых клеток:</label>
                    <input type="color" id="liveColorPicker" value="#000000">
                </div>
                 <div>
                    <label for="deadColorPicker" data-lang-key="deadColorLabel">Цвет мертвых клеток:</label>
                    <input type="color" id="deadColorPicker" value="#ffffff">
                </div>
                <div>
                    <label for="gridColorPicker" data-lang-key="gridColorLabel">Цвет сетки:</label>
                    <input type="color" id="gridColorPicker" value="#cccccc">
                </div>
                <div>
                    <label for="toggleGridLines" data-lang-key="showGridLinesLabel">Показывать сетку:</label>
                    <input type="checkbox" id="toggleGridLines" checked>
                </div>
            </div>

            <div class="setting-section">
                 <h3 data-lang-key="sizeSettingsTitle">Размер поля и границы</h3>
                 <div class="size-control">
                    <label for="gridWidthInput" data-lang-key="widthLabel">Ширина (клеток):</label>
                    <input type="number" id="gridWidthInput" min="10" value="50" style="width: 60px;">
                    <input type="range" id="gridWidthSlider" min="10" max="200" value="50" step="5">
                 </div>
                 <div class="size-control">
                    <label for="gridHeightInput" data-lang-key="heightLabel">Высота (клеток):</label>
                    <input type="number" id="gridHeightInput" min="10" value="50" style="width: 60px;">
                    <input type="range" id="gridHeightSlider" min="10" max="200" value="50" step="5">
                 </div>
                 <div>
                    <label for="toggleToroidal" data-lang-key="toroidalLabel">Бесконечное поле (тороидальное):</label>
                    <input type="checkbox" id="toggleToroidal">
                 </div>
                 <br>
                 <button id="applySizeButton" data-lang-key="applySizeButton">Применить размер/границы (очистит поле)</button>
             </div>

            <div class="setting-section">
                <h3 data-lang-key="neighborhoodSettingsTitle">Правила соседства</h3>
                <label for="neighborhoodSelect" data-lang-key="neighborhoodTypeLabel">Тип соседства:</label>
                <select id="neighborhoodSelect">
                    <option value="moore" data-lang-key="mooreNeighborhood">Мур (8 соседей)</option>
                    <option value="vonneumann" data-lang-key="vonneumannNeighborhood">Фон Нейман (4 соседа)</option>
                </select>
            </div>


            <div class="setting-section">
                <h3 data-lang-key="rulesSettingsTitle">Правила (B/S)</h3>
                <p data-lang-key="rulesFormatHint">Формат: B (рождение) / S (выживание). Например, для стандартной Жизни: 3/23</p>
                <label for="rulesInput" data-lang-key="rulesLabel">Правила:</label>
                <input type="text" id="rulesInput" value="3/23"><br><br>
                 <button id="applyRulesButton" data-lang-key="applyRulesButton">Применить правила (сбросит симуляцию)</button>
            </div>

            <div class="setting-section">
                <h3 data-lang-key="saveLoadTitle">Сохранить / Загрузить (файл JSON)</h3>
                <button id="saveToJsonButton" data-lang-key="saveToFileButton">Сохранить в файл</button>
                <br><br>
                <label for="loadFromJsonInput" data-lang-key="loadFileLabel">Загрузить из файла:</label>
                <input type="file" id="loadFromJsonInput" accept=".json">
                <p style="font-size: 0.9em; color: #888; margin-bottom: 15px;" data-lang-key="loadFileHint">(Загрузка файла автоматически применит состояние)</p>

                <button id="forceSaveButton" data-lang-key="forceSaveButton">Принудительно сохранить сессию</button>
                 <button id="clearSessionButton" data-lang-key="clearSessionButton">Очистить сохраненную сессию</button>
                 <p style="font-size: 0.9em; color: #888; margin-top: 5px;" data-lang-key="clearSessionHint">(Удалить данные из браузера)</p>

            </div>

        </div>
    </div>

    <div id="consentModal" class="modal">
        <div class="modal-content">
            <h2 data-lang-key="consentModalTitle">Согласие на использование данных</h2>
            <p data-lang-key="consentMessage">Эта игра сохраняет свое состояние (сетку, настройки и т.д.) локально в вашем браузере с помощью Local Storage, чтобы вы могли продолжить играть позже. Вы даете согласие на это?</p>
            <div class="consent-buttons" style="text-align: center; margin-top: 20px;">
                <button id="acceptConsentButton" data-lang-key="acceptConsentButton">Принять</button>
                <button id="declineConsentButton" data-lang-key="declineConsentButton">Отказаться</button>
            </div>
            </div>
    </div>


    <script src="script.js"></script>

    <div class="authors">
        <p data-lang-key="authorsText">Авторы: Gemini и M-998</p>
    </div>

</body>
</html>
